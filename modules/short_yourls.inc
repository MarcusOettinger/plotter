<?php
//
// Plotter: URL shortening via yourls
// M. Oettinger 06/2020
// License: GPL
//

$useShortening = true;
// Set $useQR to true if you want to use a YOURLS-plugin
// creating a QR-Code generated by appending .qr to the
// end of the short link (for examples, see 
// https://github.com/YOURLS/awesome-yourls
// or https://github.com/MarcusOettinger/yourls-tcpdf-qrcode)
$useQR = false;

function getshortlink($longurl) {
	global $secret, $shorten;
	
	// Open phased url
	$ch = curl_init();
	$timeout = 5;
	curl_setopt($ch, CURLOPT_URL, $shorten . $longurl);
	curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
	curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, $timeout);
	$yourlsoutput = curl_exec($ch);
	curl_close($ch);

	// Converts xml to php array
	$xml = simplexml_load_string($yourlsoutput);
	if ($xml->statusCode == 200) {
		$retval = $xml->shorturl;
	} else {
		$retval = "ERR";
	}
	return $retval;
//print_r($xml);
}
?>
